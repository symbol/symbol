from pathlib import Path

import mkdocs_gen_files

nav = mkdocs_gen_files.Nav()

# Include in navigation all Java files generated by Doxygen that start with classorg"
for f in mkdocs_gen_files.editor.FilesEditor.current().files:
    if f.src_uri.startswith("devbook/reference/java/"):
        if not f.name.startswith("classorg"):
            continue

        path = Path(f.src_uri.removeprefix("devbook/reference/java/"))
        module_path = path.relative_to(".").with_suffix("")
        doc_path = path

        parts = tuple(module_path.parts)
        nav[parts] = doc_path.as_posix()

with mkdocs_gen_files.open("devbook/reference/java/links.md", "w") as nav_file:
    nav_file.writelines(nav.build_literate_nav())


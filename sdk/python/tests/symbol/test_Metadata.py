import unittest

from symbolchain.symbol.Metadata import metadata_update_value


class MetadataTest(unittest.TestCase):
	def test_can_set_new_value_without_old_value(self):
		# Arrange:
		new_value = [0x9A, 0xC7, 0x33, 0x18, 0xA7, 0xB0, 0x36]

		# Act:
		result = metadata_update_value(None, new_value)

		# Assert:
		self.assertEqual(new_value, result)

	def test_can_update_equal_length_value(self):
		# Arrange:
		old_value = [0x9A, 0xC7, 0x33, 0x18, 0xA7, 0xB0, 0x36]
		new_value = [0xD4, 0x60, 0x82, 0xF8, 0x78, 0xFE, 0x78]

		# Act:
		result = metadata_update_value(old_value, new_value)

		# Assert:
		self.assertEqual(bytes([0x9A ^ 0xD4, 0xC7 ^ 0x60, 0x33 ^ 0x82, 0x18 ^ 0xF8, 0xA7 ^ 0x78, 0xB0 ^ 0xFE, 0x36 ^ 0x78]), result)

	def test_can_update_shorter_value(self):
		# Arrange:
		old_value = [0x9A, 0xC7, 0x33, 0x18, 0xA7, 0xB0, 0x36]
		new_value = [0xD4, 0x60, 0x82, 0xF8]

		# Act:
		result = metadata_update_value(old_value, new_value)

		# Assert:
		self.assertEqual(bytes([0x9A ^ 0xD4, 0xC7 ^ 0x60, 0x33 ^ 0x82, 0x18 ^ 0xF8, 0xA7, 0xB0, 0x36]), result)

	def test_can_update_longer_value(self):
		# Arrange:
		old_value = [0x9A, 0xC7, 0x33, 0x18, 0xA7, 0xB0, 0x36]
		new_value = [0xD4, 0x60, 0x82, 0xF8, 0x78, 0xFE, 0x78, 0xE6, 0x9D, 0xD6]

		# Act:
		result = metadata_update_value(old_value, new_value)

		# Assert:
		self.assertEqual(
			bytes([0x9A ^ 0xD4, 0xC7 ^ 0x60, 0x33 ^ 0x82, 0x18 ^ 0xF8, 0xA7 ^ 0x78, 0xB0 ^ 0xFE, 0x36 ^ 0x78, 0xE6, 0x9D, 0xD6]),
			result)
